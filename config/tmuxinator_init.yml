# ~/.tmuxinator/ws.yml

name: ws
root: /var/www

# Optional tmux socket
# socket_name: foo

# Runs before everything. Use it to start daemons etc.
# pre: sudo /etc/rc.d/mysqld start

# Runs in each window and pane before window/pane specific commands. Useful for setting up interpreter versions.
# pre_window: rbenv shell 2.0.0-p247

# Pass command line options to tmux. Useful for specifying a different tmux.conf.
# tmux_options: -f ~/.tmux.mac.conf

# Change the command to call tmux.  This can be used by derivatives/wrappers like byobu.
# tmux_command: byobu

# Specifies (by name or index) which window will be selected on project startup. If not set, the first window is used.
# startup_window: editor

# Specitifes (by index) which pane of the specified window will be selected on project startup. If not set, the first pane is used.
# startup_pane: 1

# Controls whether the tmux session should be attached to automatically. Defaults to true.
# attach: false

# Runs after everything. Use it to attach to tmux with custom options etc.
# post: tmux -CC attach -t ws

windows:
  - nginx-logs:
      layout: even-horizontal
      panes:
        - list:
            - printf '\033]2;%s\033\\' 'access-log'
            - tail -n 100 -F /var/log/nginx/access.log | perl -pe 's/( 200 )|( 304 )|( 500 | 502 | 503 )/\e[1;34m$1\e[0m\e[1;33m$2\e[0m\e[1;31m$3\e[0m/gi'
        - list:
            - printf '\033]2;%s\033\\' 'error-log'
            - tail -n 100 -F /var/log/nginx/error.log | perl -pe 's/(DEBUG)|(INFO)|(ERROR|EXCEPTION)/\e[1;34m$1\e[0m\e[1;33m$2\e[0m\e[1;31m$3\e[0m/gi'
  - php7.0-fpm-logs:
      layout: even-horizontal
      panes:
        - list:
            - printf '\033]2;%s\033\\' 'fpm-log'
            - tail -n 100 -F /var/log/php7.0-fpm.log | perl -pe 's/(NOTICE)|(STRICT)|(ERROR|EXCEPTION)/\e[1;34m$1\e[0m\e[1;33m$2\e[0m\e[1;31m$3\e[0m/gi'
  - php-code-logs:
      layout: even-horizontal
      panes:
        - list:
            - printf '\033]2;%s\033\\' 'exception-log'
            - tail -n 100 -F /tmp/php_exception.log | perl -pe 's/(DEBUG)|(INFO)|(ERROR|EXCEPTION)/\e[1;34m$1\e[0m\e[1;33m$2\e[0m\e[1;31m$3\e[0m/gi'
        - list:
            - printf '\033]2;%s\033\\' 'notice-log'
            - tail -n 100 -F /tmp/php_notice.log | perl -pe 's/(DEBUG)|(INFO)|(ERROR|EXCEPTION)/\e[1;34m$1\e[0m\e[1;33m$2\e[0m\e[1;31m$3\e[0m/gi'
        - list:
            - printf '\033]2;%s\033\\' 'module-log'
            - tail -n 100 -F /tmp/php_module.log | perl -pe 's/(DEBUG)|(INFO)|(ERROR|EXCEPTION)/\e[1;34m$1\e[0m\e[1;33m$2\e[0m\e[1;31m$3\e[0m/gi'
  - mysql-logs:
      layout: even-horizontal
      panes:
        - list:
            - printf '\033]2;%s\033\\' 'error-log'
            - tail -n 100 -F /var/log/mysql/error.log | perl -pe 's/(DEBUG)|(INFO)|(ERROR|EXCEPTION)/\e[1;34m$1\e[0m\e[1;33m$2\e[0m\e[1;31m$3\e[0m/gi'
        - list:
            - printf '\033]2;%s\033\\' 'log'
            - tail -n 100 -F /var/log/mysql/mysql.log | awk 'gsub(/^      *|    *$/,"")' | perl -pe 's/(Close stmt|Quit|Connect)|(Execute)|(ROLLBACK)/\e[1;34m$1\e[0m\e[1;33m$2\e[0m\e[1;31m$3\e[0m/gi'
  - redis-logs:
      layout: even-horizontal
      panes:
        - list:
            - printf '\033]2;%s\033\\' 'log'
            - tail -n 100 -F /var/log/redis/redis-server.log | perl -pe 's/(DEBUG)|(INFO)|(ERROR|EXCEPTION)/\e[1;34m$1\e[0m\e[1;33m$2\e[0m\e[1;31m$3\e[0m/gi'
  - mongodb-logs:
      layout: even-horizontal
      panes:
        - list:
            - printf '\033]2;%s\033\\' 'log'
            - tail -n 100 -F /var/log/mongodb/mongodb.log | perl -pe 's/(DEBUG)|(INFO)|(ERROR|EXCEPTION)/\e[1;34m$1\e[0m\e[1;33m$2\e[0m\e[1;31m$3\e[0m/gi'
  - bash: printf '\033]2;%s\033\\' 'bash'
